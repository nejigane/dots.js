/*! dots.js 2014-08-23 */!function(a,b){var c={};c.Layer=function(a,b,c){this.gl=a;var d=this.createShader(a.VERTEX_SHADER,this.shaderSource.vertex),e=this.createShader(a.FRAGMENT_SHADER,this.shaderSource.fragment);this.program=this.createProgram(d,e),a.deleteShader(d),a.deleteShader(e),this.locations={data:a.getUniformLocation(this.program,"data"),position:a.getAttribLocation(this.program,"position"),uv:a.getAttribLocation(this.program,"uv")};var f=new Float32Array([-1,-1,0,1,-1,0,-1,1,0,1,1,0]);this.vertexBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.bufferData(a.ARRAY_BUFFER,f,a.STATIC_DRAW);var g=new Float32Array([0,0,1,0,0,1,1,1]);this.uvBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),a.bufferData(a.ARRAY_BUFFER,g,a.STATIC_DRAW);var h=this.indices=new Uint8Array([0,1,2,1,3,2]);this.indexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,h,a.STATIC_DRAW),this.size={width:b,height:c},this.texture=a.createTexture(),this.data=new Uint8Array(4*b*c)},c.Layer.prototype={createShader:function(a,b){var c=this.gl,d=c.createShader(a);return c.shaderSource(d,b),c.compileShader(d),c.getShaderParameter(d,c.COMPILE_STATUS)||console.error(c.getShaderInfoLog(d)),d},createProgram:function(a,b){var c=this.gl,d=c.createProgram();return c.attachShader(d,a),c.attachShader(d,b),c.linkProgram(d),c.getProgramParameter(d,c.LINK_STATUS)||console.error(c.getProgramInfoLog(d)),d},render:function(){var a=this.gl;a.useProgram(this.program),a.uniform1i(this.locations.data,0),a.bindTexture(a.TEXTURE_2D,this.texture),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0),a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),a.pixelStorei(a.UNPACK_ALIGNMENT,4),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,this.size.width,this.size.height,0,a.RGBA,a.UNSIGNED_BYTE,this.data),a.bindBuffer(a.ARRAY_BUFFER,this.vertexBuffer),a.enableVertexAttribArray(this.locations.position),a.vertexAttribPointer(this.locations.position,3,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.uvBuffer),a.enableVertexAttribArray(this.locations.uv),a.vertexAttribPointer(this.locations.uv,2,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.indexBuffer),a.drawElements(a.TRIANGLES,this.indices.length,a.UNSIGNED_BYTE,0)},shaderSource:{vertex:["precision highp float;","precision highp int;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUv;","void main() {","  vUv = uv;","  gl_Position = vec4(position, 1.0);","}"].join("\n"),fragment:["precision highp float;","precision highp int;","uniform sampler2D data;","varying vec2 vUv;","void main() {","  gl_FragColor = texture2D(data, vUv);","}"].join("\n")}},c.Canvas=function(a,c){this.size={width:a,height:c},this.domElement=b.createElement("canvas"),this.layers=[];var d=this.gl=this.domElement.getContext("webgl",{antialias:!1});d.clearColor(0,0,0,0),d.clearDepth(1),d.clearStencil(0),d.enable(d.DEPTH_TEST),d.depthFunc(d.LEQUAL),d.enable(d.CULL_FACE),d.frontFace(d.CCW),d.cullFace(d.BACK),d.enable(d.BLEND),d.blendEquation(d.FUNC_ADD),d.blendFunc(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA),this.setScale(1),this.precision=d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.HIGH_FLOAT)&&d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.HIGH_FLOAT)?"highp":d.getShaderPrecisionFormat(d.VERTEX_SHADER,d.MEDIUM_FLOAT)&&d.getShaderPrecisionFormat(d.FRAGMENT_SHADER,d.MEDIUM_FLOAT)?"mediump":"lowp"},c.Canvas.prototype={createLayer:function(){var a=new c.Layer(this.gl,this.size.width,this.size.height);return this.layers.push(a),a},setScale:function(a){this.scale=a,this.domElement.width=a*this.size.width,this.domElement.height=a*this.size.height,this.gl.viewport(0,0,a*this.size.width,a*this.size.height)},render:function(){this.layers.forEach(function(a){a.render()})}},a.DOTS=c}(this,this.document,this.parseInt);